---
layout: post
title: "SANA: Efficient High-Resolution Image Synthesis with Linear Diffusion Transformers"
description:
date: 2025-05-12 16:25:51 +09:00
tags: AI
categories: Paper
giscus_comments: true
related_posts: false

featured: false
pretty_table: true

toc:
  beginning: false  # ë§¨ ì•ì— ëª©ì°¨
  sidebar: left  # ëª©ì°¨ê°€ ì‚¬ì´ë“œë°” ì™¼ìª½ì— ë¶™ì–´ìˆìŒ
---

Authors: Enze Xie, Junsong Chen, Junyu Chen, Han Cai, Haotian Tang, Yujun Lin, Zhekai Zhang, Muyang Li, Ligeng Zhu, Yao Lu, Song Han
Venue & Year: 25, ICLR, Oral
ë‚ ì§œ: 2025ë…„ 3ì›” 15ì¼

| ArXiv | [https://arxiv.org/abs/2410.10629](https://arxiv.org/abs/2410.10629) |
| --- | --- |
| Project Page | [https://nvlabs.github.io/Sana/](https://nvlabs.github.io/Sana/) |
| Github Code | [https://github.com/NVlabs/Sana](https://github.com/NVlabs/Sana) |

> ğŸ’¡
> 
> **Key Differentiator**
> 
> 1. Efficient Linear DiT design
> 
>     ReLU ê¸°ë°˜ Linear Attention ë„ì…
> 
>     Mix-FFN Block
> 
> 2. Deep Compression Autoencoder
> 
>     â†’ ì´ë¡œ ì¸í•œ 32ë°° ì••ì¶• ê°€ëŠ¥ìœ¼ë¡œ ì—°ì‚°ë„ ë¹¨ë¼ì§
> 
{: .block-warning }

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ì´ë²ˆì—ëŠ” SVDQuantì˜ ì €ìì¸ Song Hanì´ ë˜ ì¼ì„ ëƒˆë‹¤.

SANA ë¼ëŠ” Diffusion ëª¨ë¸ì„ NVIDIAì—ì„œ ì œì‘í–ˆëŠ”ë°, ì—­ëŒ€ê¸‰ì´ë‹¤.

ë‚´ê°€ í•˜ë ¤ë˜ On-device 4K Diffusion ì—°êµ¬ì—ë„ í¬ê²Œ ë„ì›€ë  ê²ƒ ê°™ì•„ì„œ ì½ì–´ë³´ì•˜ë‹¤.

# 1. Introduction

ì§€ë‚œ 1ë…„ë™ì•ˆ Diffusion ëª¨ë¸ì€ text-to-image ì—°êµ¬ì—ì„œ ìƒë‹¹í•œ ì§„ì „ì„ ë³´ì„.

í•˜ì§€ë§Œ, ì•„ë˜ì™€ ê°™ì´ ìƒì—… ëª¨ë¸ì€ íŒŒë¼ë¯¸í„°ê°€ ë§¤ìš° ì»¤ì§ â†’ ë†’ì€ í•™ìŠµ ë° ì¶”ë¡  ë¹„ìš©ì„ ì´ˆë˜í•˜ì—¬ ë¹„ìš©ì´ ë§ì´ ë“¤ìŒ.

> Industry models are becoming increasingly large, with parameter counts escalating from PixArtâ€™s 0.6B parameters to SD3 at 8B, LiDiT at 10B, Flux at 12B, and Playground v3 at 24B.
> 

 cloud ë¿ë§Œ ì•„ë‹ˆë¼ edge devicesì—ì„œë„ ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ëŠ” ê³ í•´ìƒë„ image generatorë¥¼ ê°œë°œí•  ìˆ˜ ì—†ì„ê¹Œ?

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%201.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ì´ ë…¼ë¬¸ì€ 1024 Ã— 1024 ~ 4096 Ã— 4096 ë²”ìœ„ì˜ í•´ìƒë„ì—ì„œ ì´ë¯¸ì§€ë¥¼ íš¨ìœ¨ì ì´ê³  ë¹„ìš© íš¨ìœ¨ì ìœ¼ë¡œ í›ˆë ¨í•˜ê³  í•©ì„±í•˜ë„ë¡ ì„¤ê³„ëœ íŒŒì´í”„ ë¼ì¸ ì¸ SANAë¥¼ ì œì•ˆ

Pixart-Ïƒ (Chen et al., 2024a)ë¥¼ ì œì™¸í•˜ê³ ëŠ” 4K í•´ìƒë„ ì´ë¯¸ì§€ ìƒì„±ì„ ì§ì ‘ íƒìƒ‰í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Pixart-ÏƒëŠ” 4K í•´ìƒë„ì— ê°€ê¹Œìš´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒìœ¼ë¡œ ì œí•œë˜ë©° (3840 Ã— 2160) ì´ëŸ¬í•œ ê³ í•´ìƒë„ ì´ë¯¸ì§€ë¥¼ ìƒì„± í•  ë•Œ ë¹„êµì  ëŠë¦½ë‹ˆë‹¤. ì´ ì•¼ì‹¬ ì°¬ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ëª‡ ê°€ì§€ í•µì‹¬ ë””ìì¸ì„ ì œì•ˆí•©ë‹ˆë‹¤.

# 2. METHODS

## 2.1 DEEP COMPRESSION AUTOENCODER

### 2.1.1 PRELIMINARY

ì›ë˜ diffusion ëª¨ë¸ì€ ì´ë¯¸ì§€ í”½ì…€ ê³µê°„ (pixel space) ìœ„ì—ì„œ ì§ì ‘ ì‘ë™ â†’ í›ˆë ¨, ì¶”ë¡  ë‘˜ë‹¤ ë„ˆë¬´ ëŠë¦¬ê³  ë¬´ê±°ì›€

**Latent Diffusion Models**

Autoencoderë¡œ ì´ë¯¸ì§€ ì••ì¶• í›„ ì••ì¶•ëœ latent ê³µê°„ ìœ„ì—ì„œ diffusionì„ ëŒë¦¬ì!

â†’ 8ë°° ì••ì¶• ì‚¬ìš©

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%202.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

**Diffusion Transformer (DiT)**

ì¶”ê°€ë¡œ latent featureë¥¼ Patch ë‹¨ìœ„ë¡œ ë˜ ë‚˜ëˆ ì„œ ì²˜ë¦¬

íŒ¨ì¹˜í¬ê¸°ê°€ PxP ë¼ë©´ ìµœì¢…ì ìœ¼ë¡œ ë‹¤ë£¨ëŠ” í† í° ê°œìˆ˜ëŠ”

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%203.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ê¸°ì¡´ latent diffusion ëª¨ë¸ë“¤(PixArt, SD3, Flux ë“±)ì€ ë³´í†µ ë‹¤ìŒ ì„¸íŒ…ì„ ì”€

- **AE-F8C4P2** ë˜ëŠ” **AE-F8C16P2**
    - **F8**: Autoencoderê°€ 8ë°° ì••ì¶•
    - **C4** ë˜ëŠ” **C16**: latent ì±„ë„ ìˆ˜ (4ê°œë‚˜ 16ê°œ)
    - **P2**: Patch í¬ê¸° 2Ã—2ë¡œ ë¬¶ê¸°

ê¸°ì¡´ì²˜ëŸ¼ 8ë°° ì••ì¶•ë§Œ í•˜ë©´ ê³„ì‚°ëŸ‰ì´ ì—¬ì „íˆ ë„ˆë¬´ ë§ìŒ

ê·¸ë˜ì„œ SANAëŠ” ê³¼ê°í•˜ê²Œ **32ë°° ì••ì¶•(AE-F32)**í•˜ê³ , íŒ¨ì¹˜ë¡œëŠ” ë¬¶ì§€ ì•ŠìŒ.

### 2.1.2 AUTOENCODER DESIGN PHILOSOPHY

| êµ¬ë¶„ | ê¸°ì¡´ (PixArt, Flux) | SANA |
| --- | --- | --- |
| AE ì••ì¶•ë¹„ | 8ë°° (F=8) | 32ë°° (F=32) |
| Patchify (P=2) | O (íŒ¨ì¹˜ë¡œ ë¬¶ìŒ) | âœ–ï¸ (íŒ¨ì¹˜ ì•ˆ ë¬¶ìŒ) |
| ìµœì¢… Token ìˆ˜ | ì¤„ì˜€ì§€ë§Œ ì•„ì§ ë§ìŒ | í›¨ì”¬ ì ìŒ (16ë°° ê°ì†Œ) |

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%204.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ìœ„ì˜ í‘œë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆë“¯ì´ 32ë°° ì••ì¶•í•˜ë”ë¼ë„ ì ìˆ˜ê°€ í¬ê²Œ ë–¨ì–´ì§€ì§€ ì•ŠëŠ” ëª¨ìŠµì„ ë³´ì„

### 2.1.3 ABLATION OF AUTOENCODER DESIGNS

- **ì–´ë””ì„œ ì••ì¶•ì„ ë” í•˜ëŠ” ê²Œ ì¢‹ì€ê°€? (AE vs DiT)**

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%205.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

| ì„¤ì • | ì„¤ëª… |
| --- | --- |
| AE-F8C16P4 | 8ë°° ì••ì¶• + íŒ¨ì¹˜ í¬ê¸° 4 |
| AE-F16C32P2 | 16ë°° ì••ì¶• + íŒ¨ì¹˜ í¬ê¸° 2 |
| AE-F32C32P1 | 32ë°° ì••ì¶• + íŒ¨ì¹˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ (SANA) |

AE-F32C32P1 ì„¤ì •ì´ ê°€ì¥ ë›°ì–´ë‚œ ì„±ëŠ¥(FID, CLIP Score)ì„ ê¸°ë¡

Autoencoderê°€ ì••ì¶•ì„ ì „ì ìœ¼ë¡œ ë‹´ë‹¹í•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ ë° í›ˆë ¨ ì•ˆì •ì„± ëª¨ë‘ì—ì„œ ê°€ì¥ ìš°ìˆ˜

- **Autoencoder latent ì±„ë„ ìˆ˜ë¥¼ ëª‡ ê°œë¡œ í•˜ëŠ” ê²Œ ì¢‹ì€ê°€?**

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%206.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

- C=16, C=32, C=64 ì‹¤í—˜ ìˆ˜í–‰
- C=16ì€ ì •ë³´ ì†ì‹¤ë¡œ ì¸í•´ í’ˆì§ˆ ì €í•˜ ë°œìƒ
- C=64ëŠ” ë³µì› í’ˆì§ˆì€ ì¢‹ì•˜ìœ¼ë‚˜ ëª¨ë¸ ë³µì¡ë„ê°€ ê¸‰ê²©íˆ ì¦ê°€í•˜ì—¬ ë¹„íš¨ìœ¨ì ì„
- C=32ê°€ ì„±ëŠ¥ê³¼ íš¨ìœ¨ ì‚¬ì´ì—ì„œ ìµœì  ê· í˜•ì„ ë‹¬ì„±í•¨

## 2.2 EFFICIENT LINEAR DIT DESIGN

- ê¸°ì¡´ diffusion transformer(ì˜ˆ: DiT) êµ¬ì¡°ëŠ” **Self-Attention**ì„ ì‚¬ìš©í•¨.
- Self-Attentionì˜ ì—°ì‚°ëŸ‰ì€ **O(NÂ²)** ì— ë¹„ë¡€í•¨.
    - NNNì€ ì…ë ¥ í† í° ìˆ˜
    - í† í° ìˆ˜ê°€ ë§ì•„ì§€ë©´ ì—°ì‚°ëŸ‰ì´ ê¸‰ê²©íˆ ì»¤ì§
- 4K í•´ìƒë„ ì´ë¯¸ì§€ë¥¼ ë‹¤ë£¨ë ¤ë©´, latent token ìˆ˜ê°€ ë§ì•„ì§ˆ ìˆ˜ë°–ì— ì—†ìŒ.

â†’ ì´ë•Œ, ê¸°ì¡´ ì—°êµ¬ë“¤ì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ê³  í•´ìƒë„ ë‚®ì¶”ê±°ë‚˜ Token ìˆ˜ë¥¼ ì¤„ì˜€ìŒ.

### ReLU ê¸°ë°˜ Linear Attention ë„ì…

ê¸°ì¡´ Softmax ê¸°ë°˜ Attentionì„ ì œê±°í•˜ê³ , **ReLUë¥¼ ì´ìš©í•œ Linear Attention**ì„ ì±„íƒ

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%207.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

SoftmaxëŠ” ëª¨ë“  Query-Token ì¡°í•©ì„ ë‹¤ ê³„ì‚°í•˜ê¸° ë•Œë¬¸ì— O(NÂ²) ë³µì¡ë„ê°€ ë°œìƒ

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%208.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

- SANAì—ì„œëŠ” ë‹¤ìŒì²˜ëŸ¼ ê³„ì‚° êµ¬ì¡°ë¥¼ ë³€ê²½í•¨
  
1. ê° Keyì— ReLUë¥¼ ì ìš©í•¨: **ReLU(K)**
2. ë‘ ê°€ì§€ ê³µìœ  termì„ ë¯¸ë¦¬ ê³„ì‚°        
{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%209.webp" class="img-fluid rounded z-depth-1" zoomable=true %}
3. ì´í›„, ê° Queryì— ëŒ€í•´ ì´ pre-computed shared termì„ ì¬ì‚¬ìš©í•˜ì—¬ Attentionì„ ê³„ì‚°
- ì´ ë°©ì‹ì€ Queryë§ˆë‹¤ ê°œë³„ì ìœ¼ë¡œ ì—°ì‚°í•  í•„ìš”ê°€ ì—†ì–´ì„œ, ì „ì²´ Attention ê³„ì‚°ì´ **O(N)** ìœ¼ë¡œ ì¤„ì–´ë“¦.

**PixArtë„ Linearì´ë¬ëŠ”ë° ë‹¤ë¥¸ì ì€?**

PixArtì—ì„œëŠ” Keyì™€ Value í† í°ì„ ì••ì¶•í•˜ì—¬ ì—°ì‚°ëŸ‰ì„ ì¤„ì—¬ì„œ Engineering Optimizationìœ¼ë¡œ O(N)ê³¼ ë¹„ìŠ·í•˜ê²Œ í•˜ëŠ” ë°©ì‹, SANAì—ì„œëŠ” ì•„ì˜ˆ ìˆ˜í•™ì ìœ¼ë¡œ ê³„ì‚°ëŸ‰ì´ O(N)

### Mix-FFN Block

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2010.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ê¸°ì¡´ Transformerì˜ FFN (Feed-Forward Network)ì€ ë‹¨ìˆœíˆ 2ê°œì˜ Linear Layerë¡œ êµ¬ì„±ë˜ì–´ ìˆì—ˆìŒ.

FFNì€ ì „ì—­ì ì¸ ì •ë³´ëŠ” ì˜ ì²˜ë¦¬í•˜ì§€ë§Œ, **ì§€ì—­ì ì¸(local) ë””í…Œì¼** ë³µì›ì—ëŠ” ì•½í–ˆìŒ.

SANAì˜ í•´ê²°ì±…:

- ê¸°ì¡´ MLP ì‚¬ì´ì— **3Ã—3 Depthwise Convolution**ì„ ì‚½ì…
- ì´ë¥¼ í†µí•´ ì§€ì—­ êµ¬ì¡°(local structure) í•™ìŠµì„ ê°•í™”
- ê²°ê³¼ì ìœ¼ë¡œ **í…ìŠ¤ì²˜, ê²½ê³„ì„ **, ì´ëŸ° ì„¸ë°€í•œ ë¶€ë¶„ ë³µì›ì— ìœ ë¦¬

### DiT without Positional Encoding (NoPE)

ê¸°ì¡´ Transformer êµ¬ì¡°ëŠ” ì…ë ¥ ìˆœì„œë¥¼ ì¸ì‹í•˜ë„ë¡ **Positional Encoding**ì„ ì‚¬ìš©í–ˆìŒ.

ì™œëƒë©´ TransformerëŠ” ì…ë ¥ ìˆœì„œë¥¼ êµ¬ë³„í•  ìˆ˜ ì—†ì—ˆê¸° ë•Œë¬¸ì—â€¦

í•˜ì§€ë§Œ 4K ê³ í•´ìƒë„ latentì²˜ëŸ¼ í† í° ìˆ˜ê°€ ë§ì„ ë•Œ, Positional Encodingì„ ê³„ì‚°í•˜ê³  ì €ì¥í•˜ëŠ” ë°ë„ ë¹„ìš©ì´ í¼.

SANAì—ì„œëŠ” ì•„ì˜ˆ Positional Encodingì„ ì œê±°í•¨

- **3Ã—3 Depthwise Convolution**ì´ Mix-FFNì— ì¶”ê°€ë˜ì–´ì„œ ì§€ì—­ì  ìœ„ì¹˜ ê´€ê³„ë¥¼ í•™ìŠµí•  ìˆ˜ ìˆìŒ.
- Linear Attentionì€ **ì „ì—­ ê´€ê³„**ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ í¬ì°©í•  ìˆ˜ ìˆìŒ.
    
    â†’ ë³„ë„ë¡œ ìœ„ì¹˜ ì •ë³´ë¥¼ ë¶€ì—¬í•˜ì§€ ì•Šì•„ë„ ì¶©ë¶„íˆ íŒ¨í„´ê³¼ êµ¬ì¡°ë¥¼ í•™ìŠµí•  ìˆ˜ ìˆìŒ.
    

ê²°ê³¼ì ìœ¼ë¡œ í’ˆì§ˆì´ ìœ ì§€ë˜ë©´ì„œ êµ¬ì¡°ê°€ ê°„ë‹¨í•´ì§€ê³  ë©”ëª¨ë¦¬ ì—°ì‚°ëŸ‰ì´ ê°ì†Œí•¨

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2011.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

### Triton Acceleration Training/Inference

Appendixì— ì¶”ê°€í•œë‹¤ê³  ë˜ì–´ìˆëŠ”ë° ì•„ì§ ê´€ë ¨ ë‚´ìš© ì—†ìŒ.

GPTê°€ ì•Œë ¤ì¤€ ë‚´ìš©

- Linear Attentionì„ êµ¬í˜„í•  ë•Œ, ë‹¨ìˆœíˆ ì•Œê³ ë¦¬ì¦˜ë§Œ ê°œì„ í•˜ëŠ” ê²ƒìœ¼ë¡œëŠ” ë¶€ì¡±í•¨.
- ì‹¤ì œ ì—°ì‚° íš¨ìœ¨ê¹Œì§€ ê·¹ëŒ€í™”í•˜ë ¤ë©´, **GPU kernel ë ˆë²¨ ìµœì í™”**ê°€ í•„ìš”í•¨.
- SANAëŠ” **Triton**ì„ ì‚¬ìš©í•˜ì—¬ Linear Attention ì—°ì‚°ì„ ì§ì ‘ ìµœì í™”í•¨.
    - Tritonì€ NVIDIAê°€ ì§€ì›í•˜ëŠ” **ì»¤ìŠ¤í…€ GPU ì»¤ë„ í”„ë¡œê·¸ë˜ë° í”„ë ˆì„ì›Œí¬**ì„.
    - CUDAë³´ë‹¤ ë‹¨ìˆœí•œ ë¬¸ë²•ìœ¼ë¡œ, ê³ ì„±ëŠ¥ ì»¤ë„ì„ ì‘ì„±í•  ìˆ˜ ìˆìŒ.

Tritonìœ¼ë¡œ ìµœì í™”í•œ ê²°ê³¼:

- Matrix ê³± ì—°ì‚°(GEMM)ê³¼ Memory Accessë¥¼ ì¤„ì„.
- ì‹¤ì œ latency(ì§€ì—° ì‹œê°„)ì™€ memory bandwidth ì†Œëª¨ë¥¼ í¬ê²Œ ê°œì„ 

## 2.3 TEXT ENCODER DESIGN

### **ì™œ T5 ëŒ€ì‹  Decoder-only LLMì„ ì‚¬ìš©í•˜ëŠ”ê°€?**

SANAëŠ” Gemmaë¥¼ Text Encoderë¡œ ì‚¬ìš©í•˜ê¸°ë¡œ ì±„íƒ

| í•­ëª© | ê¸°ì¡´ (T5) | SANA (Gemma-2) |
| --- | --- | --- |
| ëª¨ë¸ êµ¬ì¡° | Encoder-Decoder | Decoder-only |
| Reasoning ëŠ¥ë ¥ | ì œí•œì  | ë§¤ìš° ê°•í•¨ (CoT, ICL ê°€ëŠ¥) |
| ì¶”ë¡  ì†ë„ | ëŠë¦¼ (T5-XXL) | 6ë°° ë¹ ë¦„ (Gemma-2-2B) |

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2012.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

â†’ ë¹ ë¥¸ë°ë„ ë¶ˆêµ¬í•˜ê³ , CLIP Scoreì™€ FID(ì´ë¯¸ì§€ í’ˆì§ˆ ì§€í‘œ)ì—ì„œëŠ” **ì„±ëŠ¥ì´ ë¹„ìŠ·í•¨**

### Decoder-only LLMì„ Text Encoderë¡œ ì“°ë©´ì„œ ìƒê¸´ ë¬¸ì œ í•´ê²°

Decoder-only LLM (Gemma, Qwen ë“±)ì˜ í…ìŠ¤íŠ¸ ì„ë² ë”©ì€ Varianceê°€ í›¨ì”¬ í¼.

- í° ê°’ì´ í…ìŠ¤íŠ¸ ì„ë² ë”© ì•ˆì— ë§ì´ í¬í•¨ë˜ì–´ ìˆìŒ.
- Cross-Attention ì—°ì‚° ì¤‘ ìˆ˜ì¹˜ í­ë°œ(NaN)ë¡œ ì´ì–´ì§.

**ë°©ë²• 1: RMSNorm ì¶”ê°€**

Gemma-2ì˜ í…ìŠ¤íŠ¸ ì„ë² ë”© ì¶œë ¥ì— **RMSNorm**ì„ ì ìš©

RMSNorm?

- ì…ë ¥ ë²¡í„°ì˜ Varianceë¥¼ 1.0ìœ¼ë¡œ ì •ê·œí™”
- í° ê°’ì´ë‚˜ ì‘ì€ ê°’ë“¤ì„ ê· ì¼í•˜ê²Œ ë§Œë“¤ì–´ ìˆ˜ì¹˜ í­ë°œ ë°©ì§€

**ë°©ë²• 2: Learnable Scale Factor ì¶”ê°€**

- ì¶”ê°€ë¡œ, í…ìŠ¤íŠ¸ ì„ë² ë”©ì— **í•™ìŠµ ê°€ëŠ¥í•œ ì‘ì€ ìŠ¤ì¼€ì¼ íŒŒë¼ë¯¸í„°**ë¥¼ ê³±í•¨
- ì´ˆê¸° ê°’ì€ ë§¤ìš° ì‘ê²Œ ì„¤ì •í•¨ (ì˜ˆ: 0.01)
- ì´ íŒŒë¼ë¯¸í„°ê°€ í•™ìŠµì„ í†µí•´ ì ì ˆí•œ í¬ê¸°ë¡œ ì¡°ì •ë˜ë©´ì„œ ëª¨ë¸ ìˆ˜ë ´ ì†ë„ê°€ ë¹¨ë¼ì§

â†’ í›ˆë ¨ ì•ˆì •ì„± í™•ë³´ + ìˆ˜ë ´ ì†ë„ í–¥ìƒ

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2013.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

### Complex Human Instruction Improves Text-Image Alignment

GemmaëŠ” ê°•ë ¥í•œ LLMì´ì§€ë§Œ, ì‚¬ìš©ìê°€ ì§§ê±°ë‚˜ ëª¨í˜¸í•œ í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•˜ë©´ (ì˜ˆ: "a cat")

LLMì´ ì´ˆì ì„ ìƒê³  ì—‰ëš±í•œ ë‹µë³€ì„ í•  ìˆ˜ë„ ìˆìŒ.

â†’ LLMì´ í”„ë¡¬í”„íŠ¸ì—ë§Œ ì§‘ì¤‘í•˜ê²Œ ë§Œë“œëŠ” ì¶”ê°€ ì§€ì‹œë¬¸ì´ í•„ìš”í•¨.

**CHIê°€ ê·¸ë˜ì„œ ë­”ë””?**

LLMì˜ **In-Context Learning** ëŠ¥ë ¥ì„ í™œìš©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ì£¼ê¸° ì „ì—, 

LLMì—ê²Œ "ìƒ‰ìƒ, í¬ê¸°, ìœ„ì¹˜ ê´€ê³„ ê°™ì€ ì„¸ë¶€ ë¬˜ì‚¬ë¥¼ ì¶”ê°€í•´ë¼"ì™€ ê°™ì€ **ë³µì¡í•œ ëª…ë ¹ ì„¸íŠ¸**ë¥¼ í•¨ê»˜ ì œê³µí•˜ëŠ” ê²ƒ

**ê²°ê³¼ 1**

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2014.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

CHIë¥¼ ì ìš©í–ˆì„ ë•Œ, í•™ìŠµì„ ì²˜ìŒë¶€í„° í•˜ë“ (fresh training)

ì•„ë‹ˆë©´ ê¸°ì¡´ ëª¨ë¸ì„ ë¯¸ì„¸ ì¡°ì •(fine-tuning)í•˜ë“ 

**í…ìŠ¤íŠ¸-ì´ë¯¸ì§€ ì •ë ¬ ì„±ëŠ¥ì´ í–¥ìƒ**

**ê²°ê³¼ 2**

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2015.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ì§§ì€ í”„ë¡¬í”„íŠ¸(ì˜ˆ: "a cat")ë¥¼ ì…ë ¥í–ˆì„ ë•Œ,

CHIê°€ ì—†ìœ¼ë©´, ëª¨ë¸ì´ ì—‰ëš±í•œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê±°ë‚˜ í’ˆì§ˆì´ ë¶ˆì•ˆì •í•´ì§.

CHIê°€ ìˆìœ¼ë©´, ëª¨ë¸ì´ **í”„ë¡¬í”„íŠ¸ì— ì •í™•íˆ ë§ëŠ” ì•ˆì •ì ì¸ ì´ë¯¸ì§€**ë¥¼ ìƒì„±

# 3 EFFICIENT TRAINING/INFERENCE

## 3.1 DATA CURATION AND BLENDING

### 1. Multi-Caption Auto-labelling Pipeline

**ì´ë¯¸ì§€ í•˜ë‚˜ë‹¹ 4ê°œì˜ VLM(Vision-Language Models) ì„ ì´ìš©í•´ ìº¡ì…˜ì„ ìƒì„±í•¨.**

- **VILA-3B**
- **VILA-13B**
- **InternVL-28B**
- **InternVL-26B**

**â†’ ì •í™•í•œ ìº¡ì…˜** ìƒì„± (í•˜ë‚˜ë§Œ ì“°ëŠ” ê²ƒë³´ë‹¤ ì˜¤ë¥˜ ì¤„ì„)

**â†’ ë‹¤ì–‘í•œ í‘œí˜„** í™•ë³´ (ê°™ì€ ì´ë¯¸ì§€ë¥¼ ì—¬ëŸ¬ ê´€ì ì—ì„œ ë¬˜ì‚¬ ê°€ëŠ¥)

---

### 2. CLIP-Score-based Caption Sampler

**ë¬¸ì œ ìƒí™©**

- ìº¡ì…˜ì„ ì—¬ëŸ¬ ê°œ ë§Œë“¤ì—ˆëŠ”ë°,
    
    í›ˆë ¨í•  ë•Œ ì–´ë–¤ ìº¡ì…˜ì„ ì„ íƒí• ì§€ê°€ ë¬¸ì œì„.
    
- ë¬´ì‘ìœ„ë¡œ(random) í•˜ë‚˜ ê³ ë¥´ë©´:
    - í’ˆì§ˆì´ ë‚®ì€ ë¬¸ì¥ì„ ë½‘ì„ ìœ„í—˜ì´ ìˆìŒ
    - ê·¸ëŸ¬ë©´ í›ˆë ¨ì´ ëŠë ¤ì§€ê±°ë‚˜ ëª¨ë¸ í’ˆì§ˆì´ ë–¨ì–´ì§

**í•´ê²° ë°©ë²•**

- **CLIP score**ë¥¼ í™œìš©í•´ í’ˆì§ˆ ë†’ì€ ìº¡ì…˜ì„ ë½‘ëŠ” ë°©ì‹ ì‚¬ìš©
    - CLIPì€ ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ë§¤ì¹­ ì •ë„ë¥¼ ì ìˆ˜ë¡œ ê³„ì‚°í•´ì¤Œ.
- ê³¼ì •:
    1. ì´ë¯¸ì§€ì— ëŒ€í•´ ìƒì„±ëœ ê° ìº¡ì…˜ì˜ CLIP ì ìˆ˜(cic_ici)ë¥¼ ê³„ì‚°
    2. ì ìˆ˜ê°€ ë†’ì€ ìº¡ì…˜ì¼ìˆ˜ë¡ ë½‘í í™•ë¥ ì´ ë†’ê²Œ ì„¤ì •
    3. Sampling í™•ë¥  ê³µì‹:

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2016.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ì—¬ê¸°

- Ï„ëŠ” "temperature"ë¼ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°ì„.
- **Temperature ì¡°ì •ìœ¼ë¡œ ë½‘ëŠ” ê°•ë„ë¥¼ ì¡°ì ˆ**í•  ìˆ˜ ìˆìŒ:
    - Ï„ê°€ ì‘ìœ¼ë©´: ì ìˆ˜ ê°€ì¥ ë†’ì€ ìº¡ì…˜ë§Œ ê±°ì˜ í•­ìƒ ì„ íƒ
    - Ï„ê°€ í¬ë©´: ë‹¤ì–‘í•œ ìº¡ì…˜ì´ ê³ ë¥´ê²Œ ì„ íƒë¨

---

### ì‹¤í—˜ ê²°ê³¼

- Table 4 ê²°ê³¼ì— ë”°ë¥´ë©´:
    - ìº¡ì…˜ì„ ë‹¤ì–‘í•˜ê²Œ ê³¨ë¼ë„ ì´ë¯¸ì§€ í’ˆì§ˆ(FID)ì€ ê±°ì˜ ë³€í•˜ì§€ ì•ŠìŒ
    - í•˜ì§€ë§Œ **í›ˆë ¨ ì¤‘ í…ìŠ¤íŠ¸-ì´ë¯¸ì§€ ì •ë ¬**(semantic alignment)ì€ í›¨ì”¬ ì¢‹ì•„ì§

---

### **3. Cascade Resolution Training**

### ê¸°ì¡´ ë°©ì‹

- ëŒ€ë¶€ë¶„ì˜ diffusion ëª¨ë¸ì€ í•´ìƒë„ 256pxì§œë¦¬ ì´ë¯¸ì§€ë¡œ ë¨¼ì € pre-trainingì„ í•¨.
- ì´ìœ ëŠ” ì—°ì‚° ë¹„ìš©(cost)ì„ ì¤„ì´ê¸° ìœ„í•´ì„œì„.

### ë¬¸ì œì 

- 256px ì´ë¯¸ì§€ëŠ” ë””í…Œì¼(detail) ì†ì‹¤ì´ ì‹¬í•¨.
- ë”°ë¼ì„œ, ì‘ì€ í•´ìƒë„ì—ì„œ í•™ìŠµì„ ì‹œì‘í•˜ë©´:
    - ëª¨ë¸ì´ fineí•œ êµ¬ì¡°ë‚˜ í…ìŠ¤ì²˜ë¥¼ ë°°ìš°ê¸° ì–´ë ¤ì›€
    - ê²°êµ­ í° í•´ìƒë„ë¡œ ê°ˆ ë•Œ ë” ëŠë¦¬ê²Œ í•™ìŠµí•¨.

---

### SANA ë°©ì‹

- SANAëŠ” **AE-F32C32P1 êµ¬ì¡°**ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—
    
    latent ê³µê°„ì´ ë§¤ìš° ì‘ìŒ â†’ ì—°ì‚° ë¶€ë‹´ì´ ì ìŒ.
    
- ê·¸ë˜ì„œ êµ³ì´ 256pxì—ì„œ ì‹œì‘í•  í•„ìš” ì—†ì´ ë°”ë¡œ **512px**ì—ì„œ í•™ìŠµ ì‹œì‘í•¨.
- í•™ìŠµ ìˆœì„œ:
    - 512px â†’ 1024px â†’ 2K â†’ 4K ìˆœì„œë¡œ ì ì§„ì (fine-tuning)ìœ¼ë¡œ í•´ìƒë„ë¥¼ ì˜¬ë¦¼.

## 3.2 FLOW-BASED TRAINING / INFERENCE

### Flow-based Training

ê¸°ì¡´ ë°©ì‹ : noise prediction

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2017.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2018.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2019.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

â†’ ë…¸ì´ì¦ˆë¥¼ ë§ì¶”ëŠ” ê²ƒì´ í•™ìŠµ ëª©í‘œ

ë¬¸ì œì  : tê°€ ì»¤ì§€ë©´ (Diffusion ë§ˆì§€ë§‰ ë‹¨ê³„ì— ê°€ê¹Œìš°ë©´) ë…¸ì´ì¦ˆê°€ ì»¤ì ¸ì„œ ì˜ˆì¸¡ ë¶ˆì•ˆì •

ìƒˆ ë°©ì‹ : EDM ,RF

noise ëŒ€ì‹  dataë‚˜ velocity(ë…¸ì´ì¦ˆì™€ ì›ë³¸ ì´ë¯¸ì§€ ì°¨ì´) ì˜ˆì¸¡

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2020.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2021.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2022.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

ê²°êµ­ RFë¥¼ ì‚¬ìš©í•˜ì—¬ cumulative(ëˆ„ì ) errorë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŒ

### Flow-based Inference

ê¸°ì¡´ : DPM-Solver++

â†’ required 28-50 steps for high-quality samples

 í˜„ì¬ : **Flow-DPM-Solver**

1.Not predict original data, but velocity

2.substituting the scaling factor Î±t with 1 âˆ’ Ïƒt

3.time-steps are redefined over the range [0, 1] instead of [1, 1000]

â†’Generate high-quality samples in 14-20 steps

# 5. Experiments

## 1. Model Details

### Sana-0.6B

- íŒŒë¼ë¯¸í„° ìˆ˜: **590M**
- êµ¬ì¡°: **DiT-XL** ë° **PixArt-Î£**ì™€ ê±°ì˜ ë™ì¼í•œ ë ˆì´ì–´ ìˆ˜ì™€ ì±„ë„ ìˆ˜ ì‚¬ìš©
- ëª©ì : ì†Œí˜• ëª¨ë¸ë¡œë„ íš¨ìœ¨ì„±ê³¼ í’ˆì§ˆì„ ë™ì‹œì— í™•ë³´

### Sana-1.6B

- íŒŒë¼ë¯¸í„° ìˆ˜: **1.6B**
- êµ¬ì¡°:
    - **20ê°œì˜ Transformer ë ˆì´ì–´**
    - ê° ë ˆì´ì–´ë§ˆë‹¤ **2240ê°œì˜ ì±„ë„**
    - FFN ë‚´ë¶€ ì±„ë„ ìˆ˜ëŠ” **5600**
- ì´ êµ¬ì„±ì€ í•™ìŠµ íš¨ìœ¨ì„±ê³¼ ìƒì„± í’ˆì§ˆ ì‚¬ì´ì˜ ê· í˜•ì„ ê³ ë ¤í•œ ê²ƒì„

## 2. Evaluation Details

SANAëŠ” ì´ **5ê°€ì§€ ëŒ€í‘œì ì¸ í‰ê°€ ì§€í‘œ**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ì„ í‰ê°€í•¨.

| ì§€í‘œ | ì„¤ëª… |
| --- | --- |
| **FID (FrÃ©chet Inception Distance)** | ì´ë¯¸ì§€ í’ˆì§ˆì„ ìˆ˜ì¹˜ë¡œ ì¸¡ì •. ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ |
| **CLIP Score** | ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ê°„ ì˜ë¯¸ì  ì •ë ¬ ì •ë„ í‰ê°€. ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ |
| **GenEval** (Ghosh et al., 2024) | í…ìŠ¤íŠ¸-ì´ë¯¸ì§€ ì •ë ¬ í‰ê°€. ì´ 533ê°œì˜ í”„ë¡¬í”„íŠ¸ ì‚¬ìš© |
| **DPG-Bench** (Hu et al., 2024) | í…ìŠ¤íŠ¸-ì´ë¯¸ì§€ ì •ë ¬ ì •ë°€ë„ í…ŒìŠ¤íŠ¸. 1065ê°œì˜ í”„ë¡¬í”„íŠ¸ ì‚¬ìš© |
| **ImageReward** (Xu et al., 2024) | ì¸ê°„ì˜ ì£¼ê´€ì  ì„ í˜¸ë„ë¥¼ ë°˜ì˜í•œ ì ìˆ˜. 100ê°œ í”„ë¡¬í”„íŠ¸ë¡œ ì¸¡ì • |

## 3. í‰ê°€ ë°ì´í„°ì…‹

- **MJHQ-30K (Li et al., 2024a)**
    - Midjourneyì—ì„œ ìˆ˜ì§‘í•œ **30,000ê°œ ê³ í’ˆì§ˆ ì´ë¯¸ì§€** í¬í•¨
    - FID, CLIP Score ì¸¡ì •ì— ì‚¬ìš©ë¨

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2023.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2024.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

# Limitation

{% include figure.liquid loading="eager" path="files/2025-05-12-sana/image%2025.webp" class="img-fluid rounded z-depth-1" zoomable=true %}

[https://x.com/cloneofsimo/status/1864309440356470894?s=46](https://x.com/cloneofsimo/status/1864309440356470894?s=46)

ì½”ë“œê°€ ì „ë°˜ì ìœ¼ë¡œ NVIDIAì¹©ë§Œì„ ìœ„í•´ ì„¤ê³„ë˜ì–´

ë‹¤ë¥¸ GPU ì¥ë¹„ëŠ” ë¬¼ë¡ ì´ê³ ,

Mobile Deviceì—ì„œëŠ” ë‹¹ì—°íˆ ë¶ˆê°€ëŠ¥í•¨.

ì•„ë¬´ë˜ë„ NVIDIAì—ì„œ ë‚¸ ë…¼ë¬¸ì´ê¸° ë•Œë¬¸ì— Blackwell chip í™ë³´ ê²¸ NVIDIA chipì—ì„œë§Œ ê°€ëŠ¥í•˜ë„ë¡ í•œë“¯.